<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Monthly Analysis Report</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <style>
    html { overflow-y: scroll; }
    :root { --bg:#FFFFFF; --text:#18191F; --nav-bg:#F5F7FA; --btn-light-bg:rgba(67,205,255,0.45); --btn-dark-bg:#9E96D9; --box-bg:#ddd; }
    body.dark-mode { --bg:#1E1E1E; --text:#FAFAFA; --nav-bg:#2E2E2E; --btn-light-bg:#444; --btn-dark-bg:#888; --box-bg:#444; }
    body.light-mode {}
    body{margin:0;padding:0;width:100%;background:var(--bg);color:var(--text);font-family:'Inter',sans-serif;}
    .navbar{width:100%;height:84px;background:var(--nav-bg);display:flex;justify-content:center;align-items:center;position:fixed;top:0;left:0;z-index:1000;}
    .navbar-container{width:100%;max-width:1582px;display:flex;justify-content:space-between;align-items:center;padding:0 20px;}
    .nav-left{display:flex;align-items:center;gap:50px;}
    .nav-logo img{width:211px;height:40px;}
    .nav-menu{display:flex;gap:30px;}
    .nav-menu-item{font-size:16px;color:var(--text);text-decoration:none;font-weight:400;}
    .nav-menu-item.active,.nav-menu-item:hover{font-weight:500;}
    .nav-right{display:flex;gap:14px;}
    .button-login,.button-signup{padding:10px 20px;border-radius:6px;font-size:14px;font-weight:500;color:#FFF;text-decoration:none;display:flex;align-items:center;justify-content:center;}
    .button-login{background:var(--btn-light-bg);} .button-signup{background:var(--btn-dark-bg);}
    .hero-image{margin-top:84px;width:100%;height:445px;background:url("{{ url_for('static', filename='js/images/modecraft.gif') }}") center/cover no-repeat;}
    .welcome-text{margin:40px auto;max-width:1396px;text-align:center;color:var(--text);font-size:30px;font-weight:700;line-height:41px;}
    .welcome-text span{font-weight:400;}
    .image-row{display:flex;justify-content:space-evenly;align-items:center;flex-wrap:wrap;margin:40px auto;max-width:1582px;}
    .box-btn{width:calc(33.333% - 20px);height:200px;border-radius:20px;background:var(--box-bg);border:none;font-size:1rem;color:var(--text);display:flex;align-items:center;justify-content:center;text-align:center;cursor:pointer;margin:10px;}
    .box-btn.full-row{width:calc(100% - 20px);}
    /* keep popup text dark on white background in dark mode */
    body.dark-mode #popup .modal-content {
      background-color: #FFFFFF !important;
      color: #18191F !important;
    }
    body.dark-mode #popup .modal-content .modal-header,
    body.dark-mode #popup .modal-content .modal-body {
      color: #18191F !important;
    }
  </style>
</head>
<body>
  <div class="navbar">
    <div class="navbar-container">
      <div class="nav-left">
        <div class="nav-logo"><img src="https://via.placeholder.com/211x40" alt="Modecraft Logo"></div>
        <div class="nav-menu">
          <a href="{{ url_for('home') }}" class="nav-menu-item active">Home</a>
          <a href="{{ url_for('monthly') }}" class="nav-menu-item">Monthly Analysis</a>
          <a href="{{ url_for('geographical') }}" class="nav-menu-item">Geographical Analysis</a>
          <a href="{{ url_for('product') }}" class="nav-menu-item">Product Analysis</a>
        </div>
      </div>
      <div class="nav-right">
        <a href="#" class="button-login">Light</a>
        <a href="#" class="button-signup">Dark</a>
      </div>
    </div>
  </div>
  <div class="hero-image"></div>
  <div class="welcome-text">
    <h1>Monthly Analysis Report</h1>
    <span>Analyze monthly sales trends and statistics for informed decision-making.</span>
  </div>
  <div class="container mt-4">
    <div class="row mb-3">
      <div class="col-md-3">
        <label for="month-select" class="form-label">Month</label>
        <select class="form-select" id="month-select"></select>
      </div>
      <div class="col-md-3">
        <label for="year-select" class="form-label">Year</label>
        <select class="form-select" id="year-select"></select>
      </div>
    </div>
    <div class="image-row">
      <button class="box-btn report-btn" data-type="top_products_qty" style="background: url('{{ url_for('static', filename='js/images/monthly_01.png') }}') center/cover no-repeat;">Top Products<br>(Qty)</button>
      <button class="box-btn report-btn" data-type="least_products_qty" style="background: url('{{ url_for('static', filename='js/images/monthly_02.png') }}') center/cover no-repeat;">Least Products<br>(Qty)</button>
      <button class="box-btn report-btn" data-type="top_products_revenue" style="background: url('{{ url_for('static', filename='js/images/monthly_03.png') }}') center/cover no-repeat;">Top Products<br>(Revenue)</button>
      <button class="box-btn report-btn" data-type="least_products_revenue" style="background: url('{{ url_for('static', filename='js/images/monthly_04.png') }}') center/cover no-repeat;">Least Products<br>(Revenue)</button>
      <button class="box-btn report-btn" data-type="top_customers" style="background: url('{{ url_for('static', filename='js/images/monthly_05.png') }}') center/cover no-repeat;">Top Customers</button>
      <button class="box-btn report-btn" data-type="popular_days" style="background: url('{{ url_for('static', filename='js/images/monthly_06.png') }}') center/cover no-repeat;">Popular Days</button>
      <button class="box-btn report-btn" data-type="popular_times_by_day" style="background: url('{{ url_for('static', filename='js/images/monthly_07.png') }}') center/cover no-repeat;">Popular Times by Day</button>
      <button class="box-btn report-btn" data-type="top_regions" style="background: url('{{ url_for('static', filename='js/images/monthly_08.png') }}') center/cover no-repeat;">Top Regions</button>
      <button class="box-btn report-btn" data-type="summary_stats" style="background: url('{{ url_for('static', filename='js/images/monthly_09.png') }}') center/cover no-repeat;">Summary<br>Stats</button>
      <button class="box-btn report-btn full-row" data-type="revenue_suggestions">Revenue<br>Suggestions</button>
    </div>
    <script src="{{ url_for('static', filename='js/common.js') }}"></script>
    <script src="{{ url_for('static', filename='js/monthly.js') }}"></script>
    <script>
      function applyTheme(theme) {
        document.body.classList.remove('light-mode','dark-mode');
        document.body.classList.add(theme+'-mode');
        localStorage.setItem('theme', theme);
      }
      document.addEventListener('DOMContentLoaded', function() {
        var t = localStorage.getItem('theme') || 'light';
        applyTheme(t);
        document.querySelector('.button-login').addEventListener('click', function(e){e.preventDefault();applyTheme('light');});
        document.querySelector('.button-signup').addEventListener('click', function(e){e.preventDefault();applyTheme('dark');});
      });
    </script>
    <div id="popup" class="modal" tabindex="-1" style="display:none;">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Report Info</h5>
            <button type="button" class="btn-close" id="closePopup"></button>
          </div>
          <div class="modal-body" id="popup-content">
            <!-- Data will be loaded here -->
          </div>
        </div>
      </div>
    </div>
    <h3 class="mt-4">Monthly Report Chart</h3>
    <div id="report-plot" style="width: 100%; min-height: 500px;"></div>
    <div id="plot-warning" class="alert alert-warning mt-2" style="display: none;"></div>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <a href="/" class="btn btn-secondary mt-4">Back to Home</a>
  </div>
</body>
</html>
